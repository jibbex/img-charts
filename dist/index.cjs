"use strict";var b=Object.create;var h=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var C=(s,e,t)=>e in s?h(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e)=>h(s,"name",{value:e,configurable:!0});var P=(s,e)=>{for(var t in e)h(s,t,{get:e[t],enumerable:!0})},l=(s,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of y(e))!O.call(s,i)&&i!==t&&h(s,i,{get:()=>e[i],enumerable:!(a=x(e,i))||a.enumerable});return s};var T=(s,e,t)=>(t=s!=null?b(I(s)):{},l(e||!s||!s.__esModule?h(t,"default",{value:s,enumerable:!0}):t,s)),j=s=>l(h({},"__esModule",{value:!0}),s);var m=(s,e,t)=>(C(s,typeof e!="symbol"?e+"":e,t),t);var R={};P(R,{ChartDimensionError:()=>c,ChartError:()=>n,createChart:()=>D,createChartImage:()=>f,createChartImgSrc:()=>L});module.exports=j(R);var p=T(require("echarts"),1);var g=class g extends Error{constructor(e){super(e),this.name="ChartError"}};r(g,"ChartError");var n=g,w=class w extends n{constructor(e){super(e),this.name="ChartDimensionError"}};r(w,"ChartDimensionError");var c=w;function A(s){switch(s){case"png":return"image/png";case"jpeg":return"image/jpeg";case"svg":return"image/svg+xml";case"webp":return"image/webp";default:throw new n("Invalid image type")}}r(A,"chartImageTypeToMime");var o,u=(o=class{constructor(e){m(this,"chart");m(this,"option");m(this,"canvas");let t=performance.now();this.validateOptions(e),this.option=e,this.canvas=document.createElement("canvas"),this.setDimensions({width:e.width||800,height:e.height||600}),this.chart=p.init(this.canvas),this.update(e),this.logPerformance("initialization",t)}update(e){let t=performance.now();(e.width||e.height)&&this.setDimensions({width:e.width||this.canvas.width,height:e.height||this.canvas.height});let a={...e};return delete a.width,delete a.height,Array.isArray(a.series)?a.series?.forEach(i=>{i.animation=!1}):a.series&&(a.series.animation=!1),this.option={...this.option,...a},this.chart.setOption(this.option),this.logPerformance("update",t),this}setDimensions({width:e,height:t}){return this.validateOptions({width:e,height:t}),this.canvas.width=e,this.canvas.height=t,this}generateImage({type:e,quality:t}){if(t&&(t<0||t>3))throw new n("Quality must be between 0 and 3");let a=performance.now();return new Promise((i,v)=>{this.canvas.toBlob(d=>{this.logPerformance("image generation",a),d?i(d):v(new n("Failed to generate image"))},A(e),t)})}getChart(){return this.chart}getCanvas(){return this.canvas}dispose(){this.chart.dispose()}validateOptions(e){if(e.width&&e.width<=0)throw new c("Width must be positive");if(e.height&&e.height<=0)throw new c("Height must be positive")}logPerformance(e,t){console.debug(`%c\u{1F680} Chart ${e} completed in ${performance.now()-t}ms`,"color: coral; font-weight: bold")}},r(o,"Chart"),o),D=r(s=>new u(s),"createChart"),f=r(async({option:s,type:e,quality:t})=>{let a=new u(s);try{return await a.generateImage({type:e,quality:t})}finally{a.dispose()}},"createChartImage"),L=r(async({option:s,type:e,quality:t})=>{let a=await f({option:s,type:e,quality:t});return URL.createObjectURL(a)},"createChartImgSrc");0&&(module.exports={ChartDimensionError,ChartError,createChart,createChartImage,createChartImgSrc});
